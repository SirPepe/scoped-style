window.ScopedStyle=window.ScopedStyle||function(){"use strict";function escapeRegExp(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function createScope(){return"scope-"+Math.random().toString(36).slice(2)+"-"+Date.now()}function splitSelector(input){for(var result=[],index=0,quote=!1,i=0;i<input.length;i++)"undefined"==typeof result[index]&&(result[index]=""),","===input[i]&&quote===!1?index++:(['"',"'"].indexOf(input[i])!==-1&&(quote===!1?quote=input[i]:quote===input[i]&&(quote=!1)),result[index]+=input[i]);return result.map(Function.prototype.call.bind(String.prototype.trim))}function findChildren(node,selector){var descendants=node.querySelectorAll(selector);return[].filter.call(descendants,function(descendant){return descendant.parentNode===node})}function rewriteSelector(selector,scope){return splitSelector(selector).map(function(s){return selector.match(scopeSelectorRe)?"."+scope+s.replace(scopeSelectorRe,""):"."+scope+" "+s}).join(",")}function rewriteRule(rule,scope){var reSelector=new RegExp("^\\s*"+escapeRegExp(rule.selectorText)),css=rule.cssText.replace(reSelector,""),selector=rewriteSelector(rule.selectorText,scope);return selector+css}function rewriteRules(source,scope){for(var rules=source.cssRules,i=0;i<rules.length;i++)switch(rules[i].type){case 1:var newCssText=rewriteRule(rules[i],scope);source.deleteRule(i),source.insertRule(newCssText,i);break;case 4:rewriteRules(rules[i],scope)}}function setScope(node,scope){[].forEach.call(node.classList,function(className){if(className.match(scopeClassRe)){var styleNodes=findChildren(node,'[data-scope="'+className+'"]');0===styleNodes.length&&node.classList.remove(className)}}),node.classList.add(scope)}var scopeClassRe=/\bscope-[a-z0-9]*-[0-9]*\b/,scopeSelectorRe=/(?:^|\s|\n|\W)*-x-scope\b/;return document.registerElement("scoped-style",{extends:"style",prototype:Object.create(window.HTMLStyleElement.prototype,{attachedCallback:{value:function(){var scope=createScope();this.setAttribute("data-scope",scope),rewriteRules(this.sheet,scope),setScope(this.parentNode,scope)}},escapeRegExp:{value:escapeRegExp},createScope:{value:createScope},splitSelector:{value:splitSelector},findChildren:{value:findChildren},rewriteSelector:{value:rewriteSelector},rewriteRule:{value:rewriteRule},rewriteRules:{value:rewriteRules},setScope:{value:setScope}})})}();